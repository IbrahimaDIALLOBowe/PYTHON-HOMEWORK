# Import the pathlib and csv library
from pathlib import Path
import csv
import os 

# Set the file path
#Path("../../Resources/budget_data.cvs")
csvpath = os.path.join("Resources", "budget_data.csv")


total_months = []
total_profit = []
monthly_profit_change = []


# Open the csv file as an object
with open(csvpath, "r") as csvfile:

    # Pass in the csv file to the csv.reader() function
    # (with ',' as the delmiter/separator) and return the csvreader object
    csvreader = csv.reader(csvfile, delimiter=",") 
    
    #Ship the header labels to treate with values
    csv_header = next(csvreader)
    
    # Read each row of data after the header
    for row in csvreader:
        total_months.append(row[0])
        total_profit.append(int(row[1]))
        
    #Iterat through the profitd in order to get the montly change in profits
    for i in range(len(total_profit)-1):
        
        #take the difference betwen two months and append to monthly ptofit change
        monthly_profit_change.append(total_profit[i+1]-total_profit[i])

# Obtain the max and min of th monthly profit chamge and append to monthly profit change list
max_increase_value = max(monthly_profit_change)
max_decrease_value = min(monthly_profit_change)

# coreelate max and min to the proper month using month list and index from max and min
# We use the plus i at the end dince month associated withchange is the + 1 month or next month
max_increase_month = monthly_profit_change.index(max(monthly_profit_change)) + 1
max_decrease_month = monthly_profit_change.index(min(monthly_profit_change)) + 1


# Pritn Statements

print("Financial Analysis")
print("-------------------------------")
print(f"Total Months: {len(total_months)}")
print(f"Total: ${sum(total_profit)}")
print(f"Average Change: {round(sum(monthly_profit_change)/len(monthly_profit_change),2)}")
print(f"Greatest Increase in Profits: {total_months[max_increase_month]} (${(str(max_increase_value))})")
print(f"Greatest Decrease in Profits: {total_months[max_decrease_month]} (${(str(max_decrease_value))})")

Financial Analysis
-------------------------------
Total Months: 86
Total: $38382578
Average Change: -2315.12
Greatest Increase in Profits: Feb-2012 ($1926159)
Greatest Decrease in Profits: Sep-2013 ($-2196167)